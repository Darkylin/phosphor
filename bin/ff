#! /usr/bin/env node
'use strict';

const program = require('commander');
const _ = require('lodash');
const commands = require('./commands');
const appConfig = require('../package.json');

// ç‰ˆæœ¬å·
program
  .version(appConfig.version);

// æ·»åŠ å‘½ä»¤
_.forIn(commands, function (config, name) {
  program
    .command(name, config.description);
})

const argv = process.argv;

// å¯¹äºaliaså‘½ä»¤è¿›è¡Œè½¬æ¢
const cmd = argv[2];
const cmdFromAlias = _.findKey(commands, function (o) {
  const alias = o.alias;
  if (_.isArray(alias)) {
    return alias.some(function (name) {
      return name === cmd;
    })
  }
  return alias === cmd;
})
if (cmdFromAlias) {
  argv[2] = cmdFromAlias;
}
//program.on('--help', function () {
//  console.log('ğŸŒŸğŸŒŸğŸŒŸ phorsphor å¯æ˜æ˜Ÿ ğŸŒŸğŸŒŸğŸŒŸ');
//});


program.parse(argv);
if (!program.args.length) {
  program.help();
  process.exit(0);
}

//const exec = require('../lib/exec');